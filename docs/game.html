<!-- game.html - Version corrigée avec gage révélé après clic -->
<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Tap Up 🎮 - Partie</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <header>
    <img src="actif/logo.png" alt="Logo Tap Up" class="logo" />
    <h1>Partie en cours 🎲</h1>
  </header>

  <div id="scoresContainer"></div>
  <div id="questionContainer" class="question-box"></div>

  <footer>© 2025 Tap Up - Tous droits réservés</footer>

  <script>
    const Questions = {
      "Culture Générale": [
        "Quel est le plus long fleuve du monde ?",
        "En quelle année a eu lieu la Révolution française ?",
        "Quel pays a inventé les Jeux Olympiques ?",
        "Quelle est la capitale de l’Australie ?",
        "Combien y a-t-il de continents ?",
        "Qui a peint La Joconde ?",
        "Quel est l’élément chimique de symbole O ?",
        "Qui a écrit 'Les Misérables' ?",
        "Dans quel pays se trouve la ville de Marrakech ?",
        "Combien de planètes composent le système solaire ?"
      ],
      "Humour": [
        "Raconte ta meilleure blague !",
        "Fais une imitation drôle de ton voisin.",
        "Fais un rire démoniaque pendant 5 secondes.",
        "Invente un nouveau mot et donne sa définition.",
        "Fais une voix de bébé pendant une phrase.",
        "Fais une blague sur les légumes.",
        "Raconte une blague nulle mais drôle.",
        "Dis 3 jeux de mots pourris.",
        "Imite quelqu’un qui perd à Tap Up.",
        "Fais une pub bidon pour un produit imaginaire."
      ],
      "Blagues": [
        "Pourquoi les plongeurs plongent-ils toujours en arrière ?",
        "C’est l’histoire d’un pingouin...",
        "Pourquoi le poulet a-t-il traversé la route ?",
        "Que dit une imprimante à une autre ?",
        "Quelle est la boisson préférée des programmeurs ?",
        "Comment appelle-t-on un chat tombé dans un pot de peinture ?",
        "Pourquoi les squelettes ne se battent jamais entre eux ?",
        "Que fait une fraise sur un cheval ?",
        "Pourquoi les poissons vivent-ils dans l’eau salée ?",
        "Quel est le comble pour un électricien ?"
      ],
      "Défis": [
        "Fais 5 pompes maintenant !",
        "Crie 'Je suis un génie !' ici et maintenant.",
        "Fais une grimace pendant 10 secondes.",
        "Dis l’alphabet à l’envers.",
        "Tourne sur toi-même 10 fois.",
        "Dis ta phrase la plus sexy.",
        "Parle avec un accent pendant 1 minute.",
        "Fais un selfie et poste-le (ou pas 😜).",
        "Imite ton animal préféré.",
        "Fais un discours de président."
      ],
      "Mystère": [
        "Raconte un secret que personne ne connaît.",
        "Quelle est ta plus grande peur ?",
        "Si tu pouvais voyager dans le temps, où irais-tu ?",
        "Si tu devais changer de prénom, lequel choisirais-tu ?",
        "Quelle est la chose la plus folle que tu aimerais faire ?",
        "Si tu pouvais lire dans les pensées, tu commencerais par qui ?",
        "Si tu pouvais être invisible, tu ferais quoi ?",
        "Un moment où tu as eu honte ?",
        "Quelle est ta chanson honteuse préférée ?",
        "Si tu gagnais 1 million, tu fais quoi ?"
      ],
      "Dating": [
        "Ton crush idéal en 3 mots ?",
        "Premier rendez-vous parfait selon toi ?",
        "Plutôt messages ou appels ?",
        "Tu fais le premier pas ?",
        "Ton date le plus gênant ?",
        "Ta plus grande qualité en amour ?",
        "Ton pire défaut en couple ?",
        "Une chose rédhibitoire chez l’autre ?",
        "Le plus beau compliment qu’on t’ait fait ?",
        "Tu crois au coup de foudre ?"
      ],
      "Se connaître": [
        "Quel est ton talent caché ?",
        "Quel est ton rêve le plus fou ?",
        "Ta plus grande fierté ?",
        "Ce que tu changerais chez toi ?",
        "Ta devise dans la vie ?",
        "Ton plus beau souvenir ?",
        "Un moment marquant de ton enfance ?",
        "Ce qui te rend heureux ?",
        "Ta plus grande phobie ?",
        "Ton plat préféré ?"
      ],
      "Célibataires": [
        "Pourquoi es-tu toujours célibataire ? 😜",
        "Ta dernière date ?",
        "Ton plan drague préféré ?",
        "Tu préfères être seul ou mal accompagné ?",
        "Quel est ton type de personne ?",
        "As-tu déjà eu le cœur brisé ?",
        "Tu dragues comment ?",
        "Appli de rencontre ou IRL ?",
        "Coup d’un soir ou sérieux ?",
        "Ton pire râteau ?"
      ],
      "Famille": [
        "Le membre de ta famille le plus drôle ?",
        "Ton meilleur souvenir en famille ?",
        "Ton plat familial préféré ?",
        "As-tu déjà fait une bêtise en famille ?",
        "As-tu une tradition familiale ?",
        "Plutôt team maman ou papa ?",
        "Le plus bordélique chez toi ?",
        "Un moment de gêne en famille ?",
        "Ton surnom familial ?",
        "Ton rôle dans ta famille ?"
      ]
    };

    const Gages = [
      "Fais 10 squats pendant qu’on te regarde.",
      "Chante une chanson au hasard devant tout le monde.",
      "Fais une déclaration d'amour à une chaise.",
      "Répète 'Tap Up est le meilleur' 5 fois avec passion.",
      "Fais une pose de mannequin pendant 15 secondes.",
      "Danse sans musique pendant 20 secondes.",
      "Imite une célébrité jusqu'à ce qu’on devine.",
      "Dis une phrase romantique en criant.",
      "Fais un animal en mime.",
      "Tourne sur toi-même et dis l’alphabet à l’envers."
    ];

    const players = JSON.parse(localStorage.getItem("players"));
    const category = localStorage.getItem("category");
    const scores = {};
    const turnCount = {};
    let currentPlayerIndex = 0;
    const questionsAsked = [];

    players.forEach(p => {
      scores[p] = 0;
      turnCount[p] = 0;
    });

    function updateScores() {
      document.getElementById("scoresContainer").innerHTML =
        `<h3>Scores actuels :</h3>` +
        players.map(p => `<p>${p} : ${scores[p]}</p>`).join('');
    }

    function nextQuestion() {
      if (players.every(p => turnCount[p] >= 3)) return endGame();

      let player = players[currentPlayerIndex];
      if (turnCount[player] >= 3) {
        currentPlayerIndex = (currentPlayerIndex + 1) % players.length;
        return nextQuestion();
      }

      let possible = Questions[category].filter(q => !questionsAsked.includes(q));
      if (possible.length === 0) return;

      let question = possible[Math.floor(Math.random() * possible.length)];
      questionsAsked.push(question);

      document.getElementById("questionContainer").innerHTML = `
        <p>🔥 À toi de jouer, <strong>${player}</strong> !</p>
        <p class="question-text">${question}</p>
        <button class="success-btn" onclick="answer(true)">✅ Réussi</button>
        <button class="fail-btn" onclick="answer(false)">❌ Échoué</button>
      `;

      updateScores();
    }

    function answer(success) {
      const player = players[currentPlayerIndex];
      if (success) scores[player]++;
      turnCount[player]++;
      currentPlayerIndex = (currentPlayerIndex + 1) % players.length;
      nextQuestion();
    }

    function endGame() {
      let min = Math.min(...Object.values(scores));
      let losers = players.filter(p => scores[p] === min);
      let loser = losers[Math.floor(Math.random() * losers.length)];
      const gage = Gages[Math.floor(Math.random() * Gages.length)];

      document.getElementById("questionContainer").innerHTML = `
        <p class="end-title">😅 Dommage <strong>${loser}</strong>, tu as perdu !</p>
        <p class="end-sub">🎭 Clique pour découvrir ton gage :</p>
        <button class="success-btn" onclick="revealGage('${gage}')">🎁 Découvrir le gage</button>
      `;

      updateScores();
    }

    function revealGage(gage) {
      document.getElementById("questionContainer").innerHTML = `
        <p class="gage-text">🎭 Ton gage :</p>
        <p class="gage-text"><strong>${gage}</strong></p>
        <button class="fail-btn" onclick="location.href='index.html'">🔁 Rejouer</button>
      `;
    }

    window.onload = nextQuestion;
  </script>
</body>
</html>
